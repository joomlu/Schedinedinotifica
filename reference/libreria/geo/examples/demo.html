<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Demo @tanggo/geo</title>
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <style>
    body{ font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; padding:20px; }
    .row{ display:flex; flex-wrap:wrap; gap:12px; }
    .col{ flex:1 1 220px; min-width:220px; }
    label{ display:block; font-weight:600; margin-bottom:6px; }
    select, input{ width:100%; padding:8px; }
  </style>
</head>
<body>
  <h1>Demo @tanggo/geo</h1>

  <div id="geo_wrap" class="row">
    <div class="col"><label>Stato</label><select id="country"></select></div>
    <div class="col"><label>Regione</label><select id="region" disabled></select></div>
    <div class="col"><label>Provincia</label><select id="prov" disabled></select></div>
    <div class="col"><label>Citt√†</label><select id="city" disabled></select></div>
    <div class="col"><label>CAP</label><select id="cap" disabled></select></div>
  </div>

  <hr/>

  <div id="addr_wrap" class="row">
    <div class="col"><label>Tipo di Via</label><select id="addr_typeaway"><option value="">Seleziona...</option><option>Via</option><option>Viale</option><option>Piazza</option></select></div>
    <div class="col"><label>Strada</label><input id="addr_address" type="text" placeholder="Garibaldi"/></div>
    <div class="col"><label>Num.</label><input id="addr_num" type="text" placeholder="12B"/></div>
    <div class="col"><label>Int.</label><input id="addr_internal" type="text" placeholder="Scala A"/></div>
    <div class="col" style="flex-basis:100%"><small id="addr_inline" style="color:#6c757d"></small></div>
  </div>

  <hr/>
  <pre id="log"></pre>

  <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/i18n/it.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios@1.7.7/dist/axios.min.js"></script>
  <script src="../dist/browser.js"></script>
  <script>
    var endpoints = { nations: '/nations', regions: '/regions', provincesAll: '/provinces-all', citiesByProvince: '/cities-by-province', capByProvince: '/cap-by-province' };
    var geo = new (window.Libreria && Libreria.GeoSelect)({ nation: '#country', region: '#region', province: '#prov', city: '#city', cap: '#cap', preselectItaly:true, filterCapByCity:true, autoSelectUniqueCap:true, endpoints:endpoints, container: document.getElementById('geo_wrap'), onChange: function(v){ document.getElementById('log').textContent = JSON.stringify({ geo:v }, null, 2); } });
    var addr = new (window.Libreria && Libreria.AddressFields)({ root:'#addr_wrap', prefix:'addr', inlineId:'addr_inline' });
    document.getElementById('addr_wrap').addEventListener('address:change', function(e){ var prev = JSON.parse(document.getElementById('log').textContent || '{}'); prev.addr = e.detail; document.getElementById('log').textContent = JSON.stringify(prev, null, 2); });
  </script>
</body>
</html>
